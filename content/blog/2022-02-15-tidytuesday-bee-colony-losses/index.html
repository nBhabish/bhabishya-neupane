---
title: '#TidyTuesday: Bee Colony Losses'
author: Bhabishya Neupane
date: '2022-02-15'
excerpt: Visualizing Bee Colony Losses in the United States between 2015 and 2021
slug: []
categories:
  - ggplot2
  - tidyverse
tags: []
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>
<script src="{{< blogdown/postref >}}index_files/core-js/shim.min.js"></script>
<script src="{{< blogdown/postref >}}index_files/react/react.min.js"></script>
<script src="{{< blogdown/postref >}}index_files/react/react-dom.min.js"></script>
<script src="{{< blogdown/postref >}}index_files/reactwidget/react-tools.js"></script>
<script src="{{< blogdown/postref >}}index_files/htmlwidgets/htmlwidgets.js"></script>
<script src="{{< blogdown/postref >}}index_files/reactable-binding/reactable.js"></script>


<pre class="r"><code>knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, out.width = &quot;100%&quot;)</code></pre>
<div id="libraries" class="section level3">
<h3>Libraries</h3>
<pre class="r"><code>library(tidyverse)
library(nationalparkcolors)
library(paletteer)
library(tidytuesdayR)
library(extrafontdb)
library(showtextdb)
library(extrafont)
library(ggridges)
library(ggtext)
library(showtext)
library(glue)
library(geofacet)
showtext_auto()
theme_set(theme_minimal())
font_add_google(&quot;BenchNine&quot;, family = &quot;BenchNine&quot;)</code></pre>
</div>
<div id="data" class="section level3">
<h3>Data</h3>
<pre class="r"><code># Data --------------------------------------------------------------------
colony &lt;- readr::read_csv(&#39;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-01-11/colony.csv&#39;)
stressor &lt;- readr::read_csv(&#39;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-01-11/stressor.csv&#39;)</code></pre>
</div>
<div id="exploratory-data-analysis" class="section level3">
<h3>Exploratory Data Analysis</h3>
<div id="states-with-highest-bee-losses-2015-2021" class="section level4">
<h4>States with Highest Bee Losses, 2015-2021</h4>
<pre class="r"><code>max_colony_lost &lt;- colony %&gt;% 
  group_by(state) %&gt;% 
  summarize(colony_lost = sum(colony_lost, na.rm = T)) %&gt;% 
  arrange(desc(colony_lost)) %&gt;% 
  slice(-1) %&gt;% 
  slice(1:10) %&gt;% 
  pull(state)

colony %&gt;% 
  glimpse()</code></pre>
<pre><code>## Rows: 1,222
## Columns: 10
## $ year            &lt;dbl&gt; 2015, 2015, 2015, 2015, 2015, 2015, 2015, 2015, 2015, …
## $ months          &lt;chr&gt; &quot;January-March&quot;, &quot;January-March&quot;, &quot;January-March&quot;, &quot;Ja…
## $ state           &lt;chr&gt; &quot;Alabama&quot;, &quot;Arizona&quot;, &quot;Arkansas&quot;, &quot;California&quot;, &quot;Color…
## $ colony_n        &lt;dbl&gt; 7000, 35000, 13000, 1440000, 3500, 3900, 305000, 10400…
## $ colony_max      &lt;dbl&gt; 7000, 35000, 14000, 1690000, 12500, 3900, 315000, 1050…
## $ colony_lost     &lt;dbl&gt; 1800, 4600, 1500, 255000, 1500, 870, 42000, 14500, 380…
## $ colony_lost_pct &lt;dbl&gt; 26, 13, 11, 15, 12, 22, 13, 14, 4, 4, 40, 22, 18, 23, …
## $ colony_added    &lt;dbl&gt; 2800, 3400, 1200, 250000, 200, 290, 54000, 47000, 3400…
## $ colony_reno     &lt;dbl&gt; 250, 2100, 90, 124000, 140, NA, 25000, 9500, 760, 8000…
## $ colony_reno_pct &lt;dbl&gt; 4, 6, 1, 7, 1, NA, 8, 9, 7, 9, 4, 1, 2, 1, NA, 13, NA,…</code></pre>
<pre class="r"><code>colony %&gt;% 
  filter(state %in% max_colony_lost) %&gt;% 
  mutate(months = fct_relevel(months, &quot;January-March&quot;)) %&gt;% 
  ggplot(aes(months, colony_lost, fill = months))+
  geom_col()+
  scale_y_continuous(labels = scales::comma_format())+
  theme_minimal()+
  theme(text = element_text(family = &quot;BenchNine&quot;),
        axis.text.x = element_blank(), 
        legend.position = &quot;bottom&quot;,
        plot.title = element_text(size = 20))+
  scale_fill_paletteer_d(&quot;nationalparkcolors::Arches&quot;)+
  facet_wrap(~state, scales = &quot;free_y&quot;)+
  labs(title = &quot;Top 10 states w/ Highest Colonies Loss by Months, 2015-2021&quot;, 
       subtitle = &quot;California leads the run for highest colonies loss among all of the states&quot;,
       y = &quot;# of colonies lost&quot;, 
       x = &quot;&quot;, fill = &quot;Months&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-4-1.png" width="100%" height="100%" /></p>
</div>
<div id="states-with-highest-bee-colonies-renovated" class="section level4">
<h4>States with Highest Bee Colonies Renovated</h4>
<pre class="r"><code>max_colony_reno &lt;- colony %&gt;% 
  group_by(state) %&gt;% 
  summarise(colony_reno = sum(colony_reno, na.rm = TRUE)) %&gt;% 
  arrange(desc(colony_reno)) %&gt;% 
  slice(-1) %&gt;% 
  slice(1:10) %&gt;% 
  pull(state)

colony %&gt;% 
  filter(state %in% max_colony_reno) %&gt;% 
  mutate(months = fct_relevel(months, &quot;January-March&quot;)) %&gt;% 
  ggplot(aes(months, colony_reno, fill = months))+
  geom_col()+
  scale_y_continuous(labels = scales::comma_format())+
  theme_minimal()+
  theme(text = element_text(family = &quot;BenchNine&quot;),
        axis.text.x = element_blank(), 
        legend.position = &quot;bottom&quot;,
        plot.title = element_text(size = 20))+
  scale_fill_paletteer_d(&quot;nationalparkcolors::Arches&quot;)+
  facet_wrap(~state, scales = &quot;free_y&quot;)+
  labs(title = &quot;Top 10 states w/ Highest Colonies Renovated by Months, 2015-2021&quot;, 
       subtitle = &quot;California leads the run for highest colonies renovated among all of the states&quot;,
       y = &quot;# of colonies renovated&quot;, 
       x = &quot;&quot;, fill = &quot;Months&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-5-1.png" width="100%" /></p>
</div>
<div id="states-with-highest-bee-colonies-added" class="section level4">
<h4>States with Highest Bee Colonies Added</h4>
<pre class="r"><code>max_colony_added &lt;- colony %&gt;% 
  group_by(state) %&gt;% 
  summarise(colony_added = sum(colony_added, na.rm = TRUE)) %&gt;% 
  arrange(desc(colony_added)) %&gt;% 
  slice(-1) %&gt;% 
  slice(1:10) %&gt;% 
  pull(state)

colony %&gt;% 
  filter(state %in% max_colony_added) %&gt;% 
  mutate(months = fct_relevel(months, &quot;January-March&quot;)) %&gt;% 
  ggplot(aes(months, colony_added, fill = months))+
  geom_col()+
  scale_y_continuous(labels = scales::comma_format())+
  theme_minimal()+
  theme(text = element_text(family = &quot;BenchNine&quot;),
        axis.text.x = element_blank(), 
        legend.position = &quot;bottom&quot;,
        plot.title = element_text(size = 20))+
  scale_fill_paletteer_d(&quot;nationalparkcolors::Arches&quot;)+
  facet_wrap(~state, scales = &quot;free_y&quot;)+
  labs(title = &quot;Top 10 states w/ Highest Colonies Added by Months, 2015-2021&quot;, 
       subtitle = &quot;California leads the run for highest colonies added among all of the states&quot;,
       y = &quot;# of colonies added&quot;, 
       x = &quot;&quot;, fill = &quot;Months&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-6-1.png" width="100%" /></p>
<p>Takeaways:</p>
<ul>
<li><p>California definitely leads some major categories when it comes to bees. It might have to do with wonderful weather over there. Florida comes second in the standing but there’s a decent margin between California and Florida when it comes to colonies renovated, added, and lost.</p></li>
<li><p>It doesn’t look like there’s one particular month where the states lose, add, or renovate bee colonies. It really seems to depend on the states.</p></li>
</ul>
</div>
</div>
<div id="focusing-on-california" class="section level3">
<h3>Focusing on California</h3>
<p>Let’s focus on California and see what other trends and patterns can be observed and generalized. My initial assumption is we might see some bee colonies added the same month, if not the following months after losing bee colonies.</p>
<pre class="r"><code># colony %&gt;%
#   filter(state == &quot;California&quot;) %&gt;%
#   mutate(months = months %&gt;% fct_relevel(&quot;January-March&quot;)) %&gt;% 
#   ggplot(aes(colony_added, colony_lost, color = months)) +
#   geom_point() +
#   scale_y_continuous(labels = scales::comma_format()) +
#   scale_x_continuous(labels = scales::comma_format()) +
#   theme_minimal() +
#   theme(
#     text = element_text(family = &quot;BenchNine&quot;),
#     legend.position = &quot;bottom&quot;,
#     plot.title = element_text(size = 20)
#   ) +
#   scale_color_paletteer_d(&quot;nationalparkcolors::Badlands&quot;)+
#   labs(x = &quot;# of colonies added&quot;, 
#        y = &quot;# of colonies lost&quot;,
#        title = &quot;Colonies Added vs Colonies Lost in the California&quot;)


colony %&gt;% 
  filter(state == &quot;California&quot;) %&gt;% 
  select(year, months, colony_added, colony_lost, colony_reno) %&gt;% 
  pivot_longer(-c(year, months)) %&gt;% 
  mutate(months = months %&gt;% fct_reorder(value)) %&gt;% 
  ggplot(aes(months, value, fill = name))+
  geom_boxplot(outlier.alpha = 0.8, outlier.colour = &quot;midnightblue&quot;)+
  scale_fill_paletteer_d(&quot;nationalparkcolors::Arches&quot;)+
  theme(axis.ticks.x = element_line(color = &quot;black&quot;), 
        axis.line.x = element_line(color = &quot;black&quot;), 
        text = element_text(family = &quot;BenchNine&quot;), 
        legend.position = &quot;top&quot;, 
        plot.title = element_markdown(face = &quot;bold&quot;, size = 20))+
  scale_y_continuous(labels = scales::comma_format())+
  expand_limits(y = 0)+
  labs(x = &quot;&quot;, y = &quot;Count&quot;, 
       title = &quot;&lt;span style = &#39;color:#466D53&#39;&gt;California&#39;s Bee Colonies Stats&lt;/span&gt;&quot;,
       fill = &quot;&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-7-1.png" width="100%" /></p>
<p>It looks like California loses a lot of its bee colonies between January and March, but it also adds a lot during that same window. July-September sees a lot less bee colonies being lost and added. It is very difficult to generalize the idea that there is some relationship between when colonies are lost and when colonies are added. April-June sees a lot more colonies being added compared to colonies being lost.</p>
</div>
<div id="post-covid-observation" class="section level3">
<h3>Post-Covid Observation</h3>
<pre class="r"><code>colony %&gt;% 
  pivot_longer(cols = c(colony_lost, colony_added, colony_reno), names_to = &quot;metrics&quot;) %&gt;% 
  mutate(post_covid = case_when(year &lt;=2019 ~ &quot;No&quot;, 
                                TRUE ~ &quot;Yes&quot;)) %&gt;% 
  ggplot(aes(year, value, group = year, fill = post_covid))+
  geom_boxplot()+
  facet_wrap(~metrics, scales = &quot;free_y&quot;)+
  expand_limits(y = 0)+
  scale_y_log10(labels = scales::comma_format())+
  scale_fill_paletteer_d(&quot;nationalparkcolors::Arches&quot;, direction = 1)+
  theme(text = element_text(family = &quot;BenchNine&quot;), 
        legend.position = &quot;bottom&quot;)+
  labs(x = &quot;&quot;, 
       y = &quot;&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-8-1.png" width="100%" /></p>
<p>There doesn’t seem to be a massive change in anything in the post-covid era. I was expecting some of the works to have gone down by little. I do think there might be increment in number of colonies added in the post-covid era. I think observing no change or a positive change is definitely a good sign even during the tough times.</p>
</div>
<div id="colonies-lost-in-the-united-states-by-month" class="section level3">
<h3>Colonies Lost in the United States by Month</h3>
<pre class="r"><code>colony %&gt;% 
  mutate(months = months %&gt;% fct_reorder(colony_lost)) %&gt;% 
  ggplot(aes(months, colony_lost, fill = months))+
  facet_wrap(~year, scales = &quot;free_y&quot;)+
  geom_boxplot()+
  scale_y_log10(labels = scales::comma_format())+
  theme_light()+
  theme(axis.text.x = element_blank(),
        text        = element_text(family = &quot;BenchNine&quot;), 
        plot.title  = element_markdown(face = &quot;bold&quot;))+
  scale_fill_paletteer_d(&quot;nationalparkcolors::Arches&quot;)+
  labs(x = &quot;&quot;, y = &quot;# of colonies lost (log-scaled plot)&quot;, 
       title = &quot;&lt;span style = &#39;color:#466D53&#39;&gt;Colonies Lost in the United States by Months (2015 - 2021)&lt;/span&gt;&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-9-1.png" width="100%" /></p>
</div>
<div id="colonies-added-in-the-united-states-by-months" class="section level3">
<h3>Colonies Added in the United States by Months</h3>
<pre class="r"><code>colony %&gt;%
  mutate(months = months %&gt;% fct_reorder(colony_added)) %&gt;%
  ggplot(aes(months, colony_added, fill = months)) +
  facet_wrap( ~ year, scales = &quot;free_y&quot;) +
  geom_boxplot() +
  scale_y_log10(labels = scales::comma_format()) +
  theme_light() +
  theme(
    axis.text.x = element_blank(),
    text        = element_text(family = &quot;BenchNine&quot;),
    plot.title  = element_markdown(face = &quot;bold&quot;, size = 15), 
    plot.subtitle = element_markdown(face = &quot;bold&quot;),
    legend.position = &quot;bottom&quot;
  ) +
  scale_fill_paletteer_d(&quot;nationalparkcolors::Arches&quot;) +
  labs(
    x = &quot;&quot;,
    y = &quot;# of colonies added (log-scaled plot)&quot;,
    title = &quot;&lt;span style = &#39;color:#466D53&#39;&gt;Colonies Added in the United States by Months (2015 - 2021)&lt;/span&gt;&quot;,
    subtitle = &quot;Bee colonies seem to be added more between April-June&quot;, 
    fill = &quot;&quot;
  )</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-10-1.png" width="100%" /></p>
</div>
<div id="math-check" class="section level3">
<h3>Math Check</h3>
<pre class="r"><code>colony %&gt;% 
  group_by(months, year) %&gt;% 
  summarize(colony_added_median = median(colony_added, na.rm = T)) %&gt;% 
  filter(year == 2018) %&gt;% 
  reactable::reactable()</code></pre>
<div id="htmlwidget-1" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"months":["April-June","January-March","July-September","October-December"],"year":[2018,2018,2018,2018],"colony_added_median":[6000,890,1600,350]},"columns":[{"accessor":"months","name":"months","type":"character"},{"accessor":"year","name":"year","type":"numeric"},{"accessor":"colony_added_median","name":"colony_added_median","type":"numeric"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"af81f536161ffe61556c47bc092d1293","key":"af81f536161ffe61556c47bc092d1293"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>colony %&gt;% 
  group_by(months, year) %&gt;% 
  summarize(colony_added_sum = sum(colony_added, na.rm = T)) %&gt;% 
  filter(year == 2018) %&gt;% 
  reactable::reactable()</code></pre>
<div id="htmlwidget-2" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"months":["April-June","January-March","July-September","October-December"],"year":[2018,2018,2018,2018],"colony_added_sum":[1451300,1025880,527120,439280]},"columns":[{"accessor":"months","name":"months","type":"character"},{"accessor":"year","name":"year","type":"numeric"},{"accessor":"colony_added_sum","name":"colony_added_sum","type":"numeric"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"ba4ef6c7f75f8b12cf4eb0a80ea24e83","key":"ba4ef6c7f75f8b12cf4eb0a80ea24e83"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># colony %&gt;%
#   filter(year != 2021) %&gt;%
#   mutate(months = months %&gt;% fct_reorder(colony_lost)) %&gt;%
#   ggplot(aes(year, colony_lost, color = months)) +
#   geom_line() +
#   facet_geo( ~ state, scales = &quot;free_y&quot;) +
#   theme(
#     axis.text.x = element_text(angle = 90, vjust = 1),
#     legend.position = &quot;top&quot;,
#     text = element_text(family = &quot;BenchNine&quot;),
#     plot.title = element_markdown(size = 30, face = &quot;bold&quot;)
#   ) +
#   scale_y_continuous(labels = scales::comma_format(scale = 10e-3, suffix = &quot;k&quot;)) +
#   scale_color_paletteer_d(&quot;nationalparkcolors::Arches&quot;) +
#   labs(
#     title = &quot;&lt;span style = &#39;color:#466D53&#39;&gt;Bee Colonies Lost by Months in the United States (2015 - 2020)&lt;/span&gt;&quot;,
#     x = &quot;&quot;,
#     y = &quot;# of colonies lost&quot;,
#     x = &quot;&quot;,
#     color = &quot;&quot;
#   )</code></pre>
</div>
